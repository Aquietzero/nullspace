---
layout: post
title: AI学习时间 05 - 建模与模型架构
date: 2025-04-22
categories:
    - AI
tags:
    - AI
    - 学习
    - 建模方法
    - 模型架构
    - transformer
    - 自注意力机制
---

<div class="theme-color-blue" markdown=1>
`#建模方法` `#模型架构` `#transformer` `#自注意力机制`
</div>

<style>
canvas {
  display: block;
  margin: auto;
  margin-bottom: 20px;
  border:1px solid #ddd;
  width:400px;
  height:400px;
}
</style>

# 复习

- **大模型**：一个将输入转换为输出的函数，本质是一系列向量变换的组合，输入输出都是向量（张量）。

    ```ts
    const output: Tensor = Model(input: Tensor)
    ```

- **矩阵乘法**：矩阵乘法对矩阵尺寸的变化规律为 $M_{a \times b} \otimes M_{b \times c} = M_{a \times c}$

# 建模方法

这里所谈论的建模方法，只是为了方便理解已有模型的工作原理，至于如何针对一个新问题进行建模，那是一件非常艰难的事情，需要有足够的知识，敏捷的洞察力，以及丰富的经验才有可能得到一个很好的建模。这个话题实际上也超出了我的能力与认知，在这里是不太可能介绍的。

## 建模的本质

在我看来建模的本质是两点

- 寻找合适的变换
- 为变换找到解释

当然这两点是不分先后顺序的，可能是先想到一个解释，然后再寻找合适的变化，我们下面将不分先后顺序描述这两点，因为我们目前是在“解释”建模方法。下面通过三个例子来描述这两点。希望通过这三个例子来加深对这两点的理解。

### 例子1 - 图片分类

正如之前提到的一个例子，问题是：我们需要训练一个模型，对图片进行分类。

为了让问题更简单，我们忽略一些细节，假设

- 这些图片是黑白图片
- 都是动物图片
- 动物类别数量有限，并且固定为 $N$
- 输入图片大小一样，都是 $H \times W$

在这个定义下，我们的问题输入是一张图片，输出是一个类别。对于图片来说，由于是黑白图片，所以是一个二维数组，每个元素代表灰度值，取值为 $[0, 1]$。输出是一个类别，按照我们的老办法，这个输出也必须是一个张量，理论上我们只需要得到一个值，一个代表类别的值，比如 `cat`，`dog`。但再进一步思考，模型很难百分之一百猜对，而对于一些模糊的图片，判断为某种动物也是一个概率问题，所以更理想的输出，应该是一个概率分布，比如 `cat` 的概率为 $0.9$，`dog` 的概率为 $0.1$。

在这个例子下，我们的输入是一个二维数组，输出是一个概率数组，形式如下所示：

```ts
const input: Image = [
    // W 列
    [0.1, 0.2, 0.3, ...],
    [0.4, 0.5, 0.6, ...],
    ... // H 行
]
const output: Probability = [
    0.5,  // 狗
    0.2,  // 猫
    0.2,  // 鱼
    0.05, // 鸟
    0.05, // 马
]
```

所以我们理论上需要寻找一个变换 $T$，满足

$$
X_{H \times W} \otimes T_{? \times ?} = Y_{N \times 1}
$$